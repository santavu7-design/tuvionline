<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bi·ªÉu ƒê·ªì T·ª≠ Vi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            line-height: 1.4;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .tuvi-chart {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr 1fr;
            gap: 3px;
            background: #e8e8e8;
            padding: 3px;
            border-radius: 8px;
            margin-bottom: 30px;
            min-height: 900px;
        }

        .palace {
            background: #fafafa;
            border: 1px solid #ddd;
            padding: 12px;
            border-radius: 6px;
            position: relative;
            font-size: 0.9em;
        }

        .palace-coordinates {
            position: absolute;
            top: 5px;
            left: 8px;
            font-size: 0.8em;
            color: #666;
            font-weight: bold;
        }

        .palace-age {
            position: absolute;
            top: 5px;
            right: 8px;
            font-size: 0.8em;
            color: #666;
            font-weight: bold;
        }

        .palace-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            margin: 20px 0 8px 0;
            text-transform: uppercase;
        }

        .star {
            display: inline-block;
            margin: 2px 4px 2px 0;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 500;
        }

        .star.weak { 
            background: #e74c3c; 
            color: white; 
        }
        .star.strong { 
            background: #27ae60; 
            color: white; 
        }
        .star.average { 
            background: #f39c12; 
            color: white; 
        }
        .star.neutral { 
            background: #f39c12; 
            color: white; 
        }
        .star.auxiliary { 
            background: #3498db; 
            color: white; 
        }

        .special-box {
            background: #e74c3c;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            display: inline-block;
            margin: 4px 0;
        }

        .palace-bottom {
            position: absolute;
            bottom: 8px;
            left: 8px;
            right: 8px;
            font-size: 0.8em;
            color: #666;
            text-align: center;
        }

        .central-info {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            color: #333;
            padding: 20px;
            border-radius: 8px;
            grid-column: 2 / 4;
            grid-row: 2 / 4;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            border: 2px solid #8B4513;
            text-align: center;
        }

        .central-info h3 {
            color: #8B4513;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .central-info .info-row {
            display: flex;
            justify-content: space-between;
            margin: 4px 0;
            padding: 2px 0;
        }

        .central-info .info-label {
            font-weight: bold;
            color: #555;
        }

        .central-info .info-value {
            color: #333;
        }

        .central-info .info-value.red {
            color: #e74c3c;
            font-weight: bold;
        }

        .color-legend {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .legend-color.kim { background: #000; }
        .legend-color.thuy { background: #3498db; }
        .legend-color.moc { background: #27ae60; }
        .legend-color.hoa { background: #e74c3c; }
        .legend-color.tho { background: #f39c12; }

        .legend-text {
            text-align: center;
            margin-top: 15px;
            color: #666;
            font-size: 0.9em;
        }

        /* Palace positioning */
        .palace:nth-child(1) { grid-column: 1; grid-row: 1; } /* M·ªÜNH */
        .palace:nth-child(2) { grid-column: 2; grid-row: 1; } /* PH·ª§ M·∫™U */
        .palace:nth-child(3) { grid-column: 3; grid-row: 1; } /* PH√öC ƒê·ª®C */
        .palace:nth-child(4) { grid-column: 4; grid-row: 1; } /* ƒêI·ªÄN TR·∫†CH */
        .palace:nth-child(5) { grid-column: 4; grid-row: 2; } /* S·ª∞ NGHI·ªÜP */
        .palace:nth-child(6) { grid-column: 4; grid-row: 3; } /* GIAO H·ªÆU */
        .palace:nth-child(7) { grid-column: 4; grid-row: 4; } /* THI√äN DI */
        .palace:nth-child(8) { grid-column: 3; grid-row: 4; } /* T·∫¨T √ÅCH */
        .palace:nth-child(9) { grid-column: 2; grid-row: 4; } /* T√ÄI B·∫†CH */
        .palace:nth-child(10) { grid-column: 1; grid-row: 4; } /* T·ª™ N·ªÆ */
        .palace:nth-child(11) { grid-column: 1; grid-row: 3; } /* PHU TH√ä */
        .palace:nth-child(12) { grid-column: 1; grid-row: 2; } /* HUYNH ƒê·ªÜ */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>BI·ªÇU ƒê·ªí T·ª¨ VI</h1>
            <div class="subtitle">Bi·ªÉu ƒë·ªì t·ª≠ vi theo 12 cung</div>
        </div>

        <div class="tuvi-chart">
            <!-- M·ªÜNH -->
            <div class="palace">
                <div class="palace-coordinates">A. T√Ω</div>
                <div class="palace-age">1-10</div>
                <div class="palace-name">M·ªÜNH</div>
                <div class="star weak">TH√ÅI √ÇM (H)</div>
                <div>ƒê√†i phu, <span class="star average">H√≤a l·ªôc (B)</span>, Thi√™n tr√∫</div>
                <div>B·∫°ch h·ªï, Quan ph·ªß, <span class="star strong">L·ªôc t·ªìn (V)</span></div>
                <div><span class="star weak">ƒê√† la (H)</span>, B√°c sƒ©</div>
                <div><span class="star weak">Ph√° to√°i (H)</span>, T·∫£ ph·ªß</div>
                <div>Ch·ªâ b·ªëi, <span class="star strong">Thi√™n ƒë·ª©c (V)</span></div>
                <div class="special-box">Tu·∫ßn kh√¥ng</div>
                <div><span class="star weak">H√†m tr√¨ (H)</span>, <span class="star strong">H·ªìng loan (V)</span>, ƒê·∫ßu qu√¢n</div>
                <div class="palace-bottom">H·ª£i, L√¢m quan, -H√íA Tu·∫•t</div>
            </div>

            <!-- PH·ª§ M·∫™U -->
            <div class="palace">
                <div class="palace-coordinates">6 B. Ng·ªç</div>
                <div class="palace-age">11-20</div>
                <div class="palace-name">PH·ª§ M·∫™U</div>
                <div class="star strong">THAM LANG (V)</div>
                <div class="palace-bottom">ƒê·ªÉ v∆∞·ª£ng, +H√íA D·∫≠u</div>
            </div>

            <!-- PH√öC ƒê·ª®C -->
            <div class="palace">
                <div class="palace-coordinates">16 ƒê. M√πi</div>
                <div class="palace-age">21-30</div>
                <div class="palace-name">PH√öC ƒê·ª®C</div>
                <div class="star weak">THI√äN ƒê·ªíNG (H)</div>
                <div class="star weak">C·ª∞ M√îN (H)</div>
                <div>L·ª±c sƒ©, <span class="star strong">H√≥a quy·ªÅn (V)</span></div>
                <div>ƒêi·ªÅu kh√°ch, <span class="star auxiliary">K√¨nh d∆∞∆°ng (M)</span>, <span class="star strong">H√≥a k·ªµ (V)</span></div>
                <div><span class="star neutral">Qu·∫£ t√∫ (N)</span>, Nguy·ªát s√°t</div>
                <div>Tr·ª±c ph√π, Thanh long, H·ªØu b·∫≠t</div>
                <div class="palace-bottom">Suy, -TH·ªî Th√¢n</div>
            </div>

            <!-- ƒêI·ªÄN TR·∫†CH -->
            <div class="palace">
                <div class="palace-coordinates">26 M. Th√¢n</div>
                <div class="palace-age">31-40</div>
                <div class="palace-name">ƒêI·ªÄN TR·∫†CH</div>
                <div class="star average">V≈® KH√öC (B)</div>
                <div class="star auxiliary">THI√äN T∆Ø·ªöNG (M)</div>
                <div>Vong th·∫ßn</div>
                <div class="palace-bottom">B·ªánh, +KIM D·∫≠u</div>
            </div>

            <!-- S·ª∞ NGHI·ªÜP -->
            <div class="palace">
                <div class="palace-coordinates">K. D·∫≠u</div>
                <div class="palace-age">41-50</div>
                <div class="palace-name">S·ª∞ NGHI·ªÜP</div>
                <div class="star neutral">TH√ÅI D∆Ø∆†NG (N)</div>
                <div class="star average">THI√äN L∆Ø∆†NG (B)</div>
                <div><span class="star auxiliary">Thi√™n vi·ªát (M)</span>, ƒê·ªãa gi·∫£i</div>
                <div>V√¢n t√¨nh, T∆∞·ªùng t√¨nh</div>
                <div>Th√°i tu·∫ø, Ti√™u hao</div>
                <div><span class="star weak">Linh tinh (H)</span>, <span class="star auxiliary">Thi√™n kh·ªëc (M)</span></div>
                <div class="palace-bottom">M√πi, T·ª´, -KIM</div>
            </div>

            <!-- GIAO H·ªÆU -->
            <div class="palace">
                <div class="palace-coordinates">C. Tu·∫•t</div>
                <div class="palace-age">51-60</div>
                <div class="palace-name">GIAO H·ªÆU</div>
                <div class="star auxiliary">TH·∫§T S√ÅT (M)</div>
                <div>Thi·ªÅu d∆∞∆°ng, T∆∞·ªõng qu√¢n, Thi√™n qu√Ω, Thi√™n gi·∫£i, Phan an</div>
                <div><span class="star weak">ƒê·ªãa ki·∫øp</span>, Thi√™n th∆∞∆°ng, ƒê·ªãa v√µng, <span class="star weak">Thi√™n kh√¥ng (H)</span>, √Çm s√°t, Nguy·ªát gi·∫£i</div>
                <div class="palace-bottom">Ng·ªç, M√£o, -TH·ªî</div>
            </div>

            <!-- THI√äN DI -->
            <div class="palace">
                <div class="palace-coordinates">76 T. H·ª£i</div>
                <div class="palace-age">61-70</div>
                <div class="palace-name">THI√äN DI</div>
                <div class="star average">THI√äN C∆† (B)</div>
                <div>Phi li·ªám, T·∫•u th∆∞</div>
                <div><span class="star weak">ƒê·ªãa kh√¥ng</span>, V√¢n x∆∞∆°ng</div>
                <div>Thi√™n s·ª≠, <span class="star strong">Thi√™n kh√¥i (V)</span></div>
                <div>T·ª©c th·∫ßn, ƒê∆∞·ªùng ph√π</div>
                <div><span class="star strong">H√≥a khoa (V)</span></div>
                <div><span class="star average">Thi√™n m√£ (B)</span></div>
                <div>Thi√™n ph√∫c, Tu·∫ø d·ªãch</div>
                <div>Tang m√¥n, Thi√™n h√¨nh, <span class="star weak">C√¥ th·∫ßn (H)</span></div>
                <div class="palace-bottom">Tuy·ªát, -TH·ª¶Y</div>
            </div>

            <!-- T·∫¨T √ÅCH -->
            <div class="palace">
                <div class="palace-coordinates">86 N. T·ªã</div>
                <div class="palace-age">71-80</div>
                <div class="palace-name">T·∫¨T √ÅCH</div>
                <div class="star average">T·ª¨ VI (B)</div>
                <div>Quan ph√π, Ni·ªÖn gi·∫£i</div>
                <div>Thi·ªÅu √¢m, Tam thai</div>
                <div><span class="star strong">Thi√™n h·ªâ (V)</span>, Thi√™n th·ªç</div>
                <div class="palace-bottom">Thai, +TH·ª¶Y T·ªã</div>
            </div>

            <!-- T√ÄI B·∫†CH -->
            <div class="palace">
                <div class="palace-coordinates">96 Q. S·ª≠u</div>
                <div class="palace-age">81-90</div>
                <div class="palace-name">T√ÄI B·∫†CH</div>
                <div>T·ª´ ph·ªß, H√¨ th·∫ßn</div>
                <div>B·ªánh ph·ªß, <span class="star average">Long tri (B)</span></div>
                <div><span class="star auxiliary">H·ªèa tinh (M)</span>, <span class="star average">Ph∆∞∆°ng c√°c (B)</span></div>
                <div><span class="star average">Ki·∫øp s√°t (B)</span>, <span class="star average">Gi·∫£i th·∫ßn (B)</span></div>
                <div class="special-box">Ti·ªát kh√¥ng</div>
                <div>Phong c√°o, <span class="star weak">Hoa c√°i (H)</span></div>
                <div class="palace-bottom">D∆∞·ª°ng, -TH·ªî Th√¨n</div>
            </div>

            <!-- T·ª™ N·ªÆ -->
            <div class="palace">
                <div class="palace-coordinates">N. D·∫ßn</div>
                <div class="palace-age">91-100</div>
                <div class="palace-name">T·ª™ N·ªÆ</div>
                <div class="star weak">PH√Å QU√ÇN (H)</div>
                <div>B√°t t·ªça, Nguy·ªát ƒë·ª©c</div>
                <div>Qu·ªëc ·∫•n, Thi√™n t√†i</div>
                <div><span class="star strong">Thi√™n quan (V)</span>, Thi√™n vu</div>
                <div class="palace-bottom">D·∫ßn, Tr∆∞·ªùng sinh, +M·ªòC M√£o</div>
            </div>

            <!-- PHU TH√ä -->
            <div class="palace">
                <div class="palace-coordinates">Q. M√£o</div>
                <div class="palace-age">101-110</div>
                <div class="palace-name">PHU TH√ä</div>
                <div><span class="star auxiliary">V√¢n kh√∫c</span>, Thi√™n y</div>
                <div>Tu·∫ø ph√°, <span class="star neutral">ƒê·∫°i hao (N)</span></div>
                <div><span class="star auxiliary">Thi√™n h∆∞ (M)</span>, Thi√™n ƒëi·ªÅu</div>
                <div>Tai s√°t</div>
                <div class="special-box">Ti·ªát kh√¥ng</div>
                <div class="palace-bottom">S·ª≠u, M·ªôc d·ª•c, -M·ªòC</div>
            </div>

            <!-- HUYNH ƒê·ªÜ -->
            <div class="palace">
                <div class="palace-coordinates">G. Th√¨n</div>
                <div class="palace-age">111-120</div>
                <div class="palace-name">HUYNH ƒê·ªÜ</div>
                <div class="star strong">LI√äM TRINH (V)</div>
                <div class="star auxiliary">THI√äN PH·ª¶ (M)</div>
                <div>Long ƒë·ª©c, √Çn quang</div>
                <div>Ph·ª•c b√¨nh, Thi√™n la</div>
                <div>L∆∞u h√†, Thi√™n nguy·ªát</div>
                <div>Thi√™n s√°t</div>
                <div class="special-box">Tu·∫ßn kh√¥ng</div>
                <div class="palace-bottom">Ti, Quan ƒë·ªõi, +TH·ªî</div>
            </div>

            <!-- Central Info Block -->
            <div class="central-info">
                <h3>TH√îNG TIN CH√çNH</h3>
                <div class="info-row">
                    <span class="info-label">NƒÉm:</span>
                    <span class="info-value">ƒêinh D·∫≠u</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Th√°ng:</span>
                    <span class="info-value">3 (Gi√°p Th√¨n)</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Ng√†y:</span>
                    <span class="info-value">19</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Gi·ªù:</span>
                    <span class="info-value">H·ª£i</span>
                </div>
                <div class="info-row">
                    <span class="info-label">√Çm D∆∞∆°ng:</span>
                    <span class="info-value">√Çm N·ªØ</span>
                </div>
                <div class="info-row">
                    <span class="info-label">M·ªánh:</span>
                    <span class="info-value red">S∆†N H·∫† H√ìA</span>
                </div>
                <div class="info-row">
                    <span class="info-label">C·ª•c:</span>
                    <span class="info-value red">H√ìA L·ª§C C·ª§C</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Th√¢n c∆∞:</span>
                    <span class="info-value">Phu th√™</span>
                </div>
                <div class="info-row">
                    <span class="info-label">M·ªánh ch·ªß:</span>
                    <span class="info-value">V≈© kh√∫c</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Th√¢n ch·ªß:</span>
                    <span class="info-value">Thi√™n ƒë·ªìng</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Sao ch·ªß c·ª•c:</span>
                    <span class="info-value">Li√™m trinh</span>
                </div>
            </div>
        </div>

        <div class="color-legend">
            <div class="legend-item">
                <div class="legend-color kim"></div>
                <span>Kim</span>
            </div>
            <div class="legend-item">
                <div class="legend-color thuy"></div>
                <span>Th·ªßy</span>
            </div>
            <div class="legend-item">
                <div class="legend-color moc"></div>
                <span>M·ªôc</span>
            </div>
            <div class="legend-item">
                <div class="legend-color hoa"></div>
                <span>H·ªèa</span>
            </div>
            <div class="legend-item">
                <div class="legend-color tho"></div>
                <span>Th·ªï</span>
            </div>
        </div>

        <div class="legend-text">
            M: Nh√¢m Mi·∫øu, V: Th·ª´a V∆∞·ª£ng, B: B√¨nh Cung, N: Nh·∫≠n ƒê·ªãa, H: L·∫°c H√£m
        </div>

        <!-- Data Loading Section -->
        <div style="margin-top: 30px; text-align: center;">
            <button id="loadMdBtn" style="background: #3498db; color: white; padding: 12px 24px; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; margin: 10px;">
                üìÅ T·∫£i d·ªØ li·ªáu t·ª´ file MD
            </button>
            <button id="loadSampleBtn" style="background: #27ae60; color: white; padding: 12px 24px; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; margin: 10px;">
                üéØ T·∫£i d·ªØ li·ªáu m·∫´u
            </button>
            <button id="testFileBtn" style="background: #f39c12; color: white; padding: 12px 24px; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; margin: 10px;">
                üîç Ki·ªÉm tra file
            </button>
            <button id="clearBtn" style="background: #e74c3c; color: white; padding: 12px 24px; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; margin: 10px;">
                üóëÔ∏è X√≥a d·ªØ li·ªáu
            </button>
        </div>

        <div id="status" style="margin: 20px; padding: 15px; border-radius: 8px; text-align: center; display: none;"></div>
    </div>

    <script>
        // Function to show status message
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.style.display = 'block';
            statusDiv.style.background = type === 'error' ? '#f8d7da' : 
                                       type === 'success' ? '#d4edda' : '#d1ecf1';
            statusDiv.style.color = type === 'error' ? '#721c24' : 
                                   type === 'success' ? '#155724' : '#0c5460';
            statusDiv.style.border = `1px solid ${type === 'error' ? '#f5c6cb' : 
                                               type === 'success' ? '#c3e6cb' : '#bee5eb'}`;
            statusDiv.innerHTML = message;
        }

        // Function to parse markdown data
        function parseMarkdownToData(markdownText) {
            const data = {
                cungTuVi: {}
            };
            
            const lines = markdownText.split('\n');
            let currentSection = '';
            let currentCung = '';
            
            for (let line of lines) {
                line = line.trim();
                if (!line) continue;
                
                // Check for main sections
                if (line.startsWith('## ')) {
                    currentCung = line.substring(3).trim();
                    if (!data.cungTuVi[currentCung]) {
                        data.cungTuVi[currentCung] = {
                            diaChi: '',
                            chinhTinh: '',
                            phuTinhTot: '',
                            phuTinhXau: '',
                            phuTinhTrungBinh: '',
                            vongTrangSinh: '',
                            special: '',
                            coordinates: '',
                            ageRange: '',
                            isThan: false // Added for TH√ÇN/N/TH·ª¶Y
                        };
                    }
                }
                
                // Parse personal info from header
                if (line.includes('ho_ten:')) {
                    data.hoTen = line.split(':')[1]?.trim() || '';
                } else if (line.includes('gioi_tinh:')) {
                    data.gioiTinh = line.split(':')[1]?.trim() || '';
                } else if (line.includes('duong_lich:')) {
                    data.duongLich = line.split(':')[1]?.trim() || '';
                } else if (line.includes('am_lich:')) {
                    data.amLich = line.split(':')[1]?.trim() || '';
                } else if (line.includes('noi_sinh:')) {
                    data.noiSinh = line.split(':')[1]?.trim() || '';
                } else if (line.includes('ban_menh:')) {
                    data.banMenh = line.split(':')[1]?.trim() || '';
                } else if (line.includes('cuc:')) {
                    data.cuc = line.split(':')[1]?.trim() || '';
                } else if (line.includes('am_duong:')) {
                    data.amDuong = line.split(':')[1]?.trim() || '';
                } else if (line.includes('chu_menh:')) {
                    data.chuMenh = line.split(':')[1]?.trim() || '';
                } else if (line.includes('chu_than:')) {
                    data.chuThan = line.split(':')[1]?.trim() || '';
                }
                
                // Parse cung data
                if (currentCung && data.cungTuVi[currentCung]) {
                    const cung = data.cungTuVi[currentCung];
                    
                    if (line.includes('dia_chi:')) {
                        cung.diaChi = line.split(':')[1]?.trim() || '';
                    } else if (line.includes('chinh_tinh:')) {
                        cung.chinhTinh = line.split(':')[1]?.trim() || '';
                    } else if (line.includes('phu_tinh_tot:')) {
                        cung.phuTinhTot = line.split(':')[1]?.trim() || '';
                    } else if (line.includes('phu_tinh_xau:')) {
                        cung.phuTinhXau = line.split(':')[1]?.trim() || '';
                    } else if (line.includes('phu_tinh_trung_binh:')) {
                        cung.phuTinhTrungBinh = line.split(':')[1]?.trim() || '';
                    } else if (line.includes('vong_trang_sinh:')) {
                        cung.vongTrangSinh = line.split(':')[1]?.trim() || '';
                    } else if (line.includes('is_than:')) {
                        cung.isThan = line.split(':')[1]?.trim() === 'true';
                    }
                }
            }
            
            // Set default values for missing fields
            data.nam = data.amLich ? data.amLich.split(' ')[1] || 'N/A' : 'N/A';
            data.thang = data.amLich ? data.amLich.split(' ')[0] || 'N/A' : 'N/A';
            data.ngay = '19'; // Default from am_lich
            data.gio = '14:30'; // Default from duong_lich
            data.saoChuCuc = 'N/A';
            data.thanCu = 'N/A';
            
            return data;
        }

        // Function to display data on the interface
        function displayDataOnInterface(data) {
            if (!data || !data.cungTuVi) {
                showStatus('Kh√¥ng c√≥ d·ªØ li·ªáu h·ª£p l·ªá ƒë·ªÉ hi·ªÉn th·ªã', 'error');
                return;
            }

            // Update central info
            const centralInfo = document.querySelector('.central-info');
            if (centralInfo) {
                centralInfo.innerHTML = `
                    <h3>TH√îNG TIN CH√çNH</h3>
                    <div class="info-row">
                        <span class="info-label">H·ªç t√™n:</span>
                        <span class="info-value">${data.hoTen || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Gi·ªõi t√≠nh:</span>
                        <span class="info-value">${data.gioiTinh || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">D∆∞∆°ng l·ªãch:</span>
                        <span class="info-value">${data.duongLich || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">√Çm l·ªãch:</span>
                        <span class="info-value">${data.amLich || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">N∆°i sinh:</span>
                        <span class="info-value">${data.noiSinh || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">B·∫£n m·ªánh:</span>
                        <span class="info-value red">${data.banMenh || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">C·ª•c:</span>
                        <span class="info-value red">${data.cuc || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">√Çm D∆∞∆°ng:</span>
                        <span class="info-value">${data.amDuong || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">M·ªánh ch·ªß:</span>
                        <span class="info-value">${data.chuMenh || 'N/A'}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Th√¢n ch·ªß:</span>
                        <span class="info-value">${data.chuThan || 'N/A'}</span>
                    </div>
                `;
            }

            // Update palaces - map Vietnamese cung names to display names
            const cungMapping = {
                'm·ªánh': 1, 'ph·ª• m·∫´u': 2, 'ph√∫c ƒë·ª©c': 3, 'ƒëi·ªÅn tr·∫°ch': 4,
                'quan l·ªôc': 5, 'n√¥ b·ªôc': 6, 'thi√™n di': 7, 't·∫≠t √°ch': 8,
                't√†i b·∫°ch': 9, 't·ª≠ t·ª©c': 10, 'phu th√™': 11, 'huynh ƒë·ªá': 12
            };

            const displayNames = {
                'm·ªánh': 'M·ªÜNH', 'ph·ª• m·∫´u': 'PH·ª§ M·∫™U', 'ph√∫c ƒë·ª©c': 'PH√öC ƒê·ª®C', 'ƒëi·ªÅn tr·∫°ch': 'ƒêI·ªÄN TR·∫†CH',
                'quan l·ªôc': 'S·ª∞ NGHI·ªÜP', 'n√¥ b·ªôc': 'GIAO H·ªÆU', 'thi√™n di': 'THI√äN DI', 't·∫≠t √°ch': 'T·∫¨T √ÅCH',
                't√†i b·∫°ch': 'T√ÄI B·∫†CH', 't·ª≠ t·ª©c': 'T·ª¨ N·ªÆ', 'phu th√™': 'PHU TH√ä', 'huynh ƒë·ªá': 'HUYNH ƒê·ªÜ'
            };

            Object.keys(cungMapping).forEach(cungName => {
                const palaceIndex = cungMapping[cungName];
                const palace = document.querySelector(`.palace:nth-child(${palaceIndex})`);
                const cungData = data.cungTuVi[cungName];
                
                if (palace && cungData) {
                    // Update palace content based on parsed data
                    let content = `
                        <div class="palace-coordinates">${cungData.diaChi || 'N/A'}</div>
                        <div class="palace-age">${cungData.isThan ? 'TH√ÇN' : 'N/A'}</div>
                        <div class="palace-name">${displayNames[cungName]}</div>
                    `;
                    
                    if (cungData.chinhTinh) {
                        content += `<div class="star weak">${cungData.chinhTinh}</div>`;
                    }
                    
                    if (cungData.phuTinhTot) {
                        content += `<div>${cungData.phuTinhTot}</div>`;
                    }
                    
                    if (cungData.phuTinhXau) {
                        content += `<div>${cungData.phuTinhXau}</div>`;
                    }
                    
                    if (cungData.phuTinhTrungBinh) {
                        content += `<div>${cungData.phuTinhTrungBinh}</div>`;
                    }
                    
                    content += `<div class="palace-bottom">${cungData.vongTrangSinh || 'N/A'}</div>`;
                    
                    palace.innerHTML = content;
                }
            });

            showStatus('ƒê√£ t·∫£i d·ªØ li·ªáu th√†nh c√¥ng!', 'success');
        }

        // Function to load markdown file
        async function loadMarkdownFile() {
            try {
                showStatus('ƒêang t·∫£i file markdown...', 'info');
                
                // Try to load the file with better error handling
                const response = await fetch('sample_gemini_response.md', {
                    method: 'GET',
                    headers: {
                        'Accept': 'text/plain, text/markdown, */*',
                        'Cache-Control': 'no-cache'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);
                }
                
                const markdownText = await response.text();
                console.log('Loaded markdown content:', markdownText.substring(0, 200) + '...');
                
                const parsedData = parseMarkdownToData(markdownText);
                console.log('Parsed data:', parsedData);
                
                // Save to localStorage
                localStorage.setItem('current_tuvi_result', JSON.stringify(parsedData));
                
                // Display on interface
                displayDataOnInterface(parsedData);
                
            } catch (error) {
                console.error('Error loading markdown:', error);
                
                // More detailed error messages
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    showStatus('L·ªói: Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn file. H√£y ƒë·∫£m b·∫£o file sample_gemini_response.md t·ªìn t·∫°i v√† server ƒëang ch·∫°y.', 'error');
                } else if (error.message.includes('HTTP error')) {
                    showStatus(`L·ªói HTTP: ${error.message}`, 'error');
                } else {
                    showStatus(`L·ªói khi t·∫£i file: ${error.message}`, 'error');
                }
                
                // Try to provide helpful debugging info
                showStatus('üí° G·ª£i √Ω: H√£y ki·ªÉm tra console ƒë·ªÉ xem chi ti·∫øt l·ªói', 'error');
            }
        }

        // Function to load sample data
        function loadSampleData() {
            const sampleData = {
                nam: "ƒêinh D·∫≠u",
                thang: "3 (Gi√°p Th√¨n)",
                ngay: "19",
                gio: "H·ª£i",
                amDuong: "√Çm N·ªØ",
                banMenh: "S∆†N H·∫† H√ìA",
                cuc: "H√ìA L·ª§C C·ª§C",
                thanCu: "Phu th√™",
                chuMenh: "V≈© kh√∫c",
                chuThan: "Thi√™n ƒë·ªìng",
                saoChuCuc: "Li√™m trinh",
                cungTuVi: {
                    'm·ªánh': {
                        coordinates: "A. T√Ω",
                        ageRange: "1-10",
                        diaChi: "H·ª£i",
                        chinhTinh: "TH√ÅI √ÇM (H)",
                        phuTinhTot: "ƒê√†i phu, H√≤a l·ªôc (B), Thi√™n tr√∫, B·∫°ch h·ªï, Quan ph·ªß, L·ªôc t·ªìn (V), Thi√™n ƒë·ª©c (V)",
                        phuTinhXau: "ƒê√† la (H), B√°c sƒ©, Ph√° to√°i (H), T·∫£ ph·ªß, Ch·ªâ b·ªëi, H√†m tr√¨ (H), H·ªìng loan (V), ƒê·∫ßu qu√¢n",
                        vongTrangSinh: "L√¢m quan",
                        special: "Tu·∫ßn kh√¥ng",
                        isThan: false
                    }
                    // Add more cung data as needed
                }
            };
            
            localStorage.setItem('current_tuvi_result', JSON.stringify(sampleData));
            displayDataOnInterface(sampleData);
        }

        // Function to test file existence
        async function testFile() {
            try {
                showStatus('ƒêang ki·ªÉm tra file...', 'info');
                
                // Test if file exists
                const response = await fetch('sample_gemini_response.md', { method: 'HEAD' });
                
                if (response.ok) {
                    showStatus(`‚úÖ File t·ªìn t·∫°i! Status: ${response.status} - ${response.statusText}`, 'success');
                    
                    // Try to get file info
                    const contentResponse = await fetch('sample_gemini_response.md');
                    const content = await contentResponse.text();
                    const fileSize = content.length;
                    
                    showStatus(`‚úÖ File t·ªìn t·∫°i! K√≠ch th∆∞·ªõc: ${fileSize} k√Ω t·ª±<br>D√≤ng ƒë·∫ßu: ${content.split('\n')[0]}`, 'success');
                    
                } else {
                    showStatus(`‚ùå File kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng th·ªÉ truy c·∫≠p. Status: ${response.status}`, 'error');
                }
                
            } catch (error) {
                console.error('Test file error:', error);
                showStatus(`‚ùå L·ªói khi ki·ªÉm tra file: ${error.message}`, 'error');
                
                // Provide debugging tips
                showStatus(`‚ùå L·ªói khi ki·ªÉm tra file: ${error.message}<br><br>üí° G·ª£i √Ω: H√£y ki·ªÉm tra:<br>1. File sample_gemini_response.md c√≥ t·ªìn t·∫°i kh√¥ng?<br>2. Server c√≥ ƒëang ch·∫°y kh√¥ng?<br>3. Console c√≥ hi·ªÉn th·ªã l·ªói g√¨ kh√¥ng?`, 'error');
            }
        }

        // Function to clear data
        function clearData() {
            localStorage.removeItem('current_tuvi_result');
            location.reload(); // Reload to show default interface
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Check if there's stored data
            const storedData = localStorage.getItem('current_tuvi_result');
            if (storedData) {
                try {
                    const parsedData = JSON.parse(storedData);
                    displayDataOnInterface(parsedData);
                } catch (e) {
                    console.log('Invalid stored data, using default interface');
                }
            }

            // Add button event listeners
            document.getElementById('loadMdBtn').addEventListener('click', loadMarkdownFile);
            document.getElementById('loadSampleBtn').addEventListener('click', loadSampleData);
            document.getElementById('testFileBtn').addEventListener('click', testFile);
            document.getElementById('clearBtn').addEventListener('click', clearData);
        });
    </script>
</body>
</html>
